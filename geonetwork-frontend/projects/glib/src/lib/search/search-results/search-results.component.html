<!--@defer (on viewport) {-->
@if (search) {
  <g-search-results-error [error]="search.error()" />
  @if (search.response(); as response) {
    <p-dataView #dv [value]="response.hits.hits" emptyMessage=" ">
      <ng-template pTemplate="list" let-hits>
        @for (hit of hits; track hit._id) {
          <div
            class="grid gap-4 mb-2 rounded-lg border-l-8 -left-8 border-transparent hover:border-indigo-500">
            <a
              class="flex flex-row gap-4"
              routerLink="/metadata/{{ hit._id }}"
              title="{{ hit._source.resourceAbstractObject?.default }}">
              <div class="flex-none w-48 h-48 relative border border-gray-300">
                <g-record-field-overview [field]="hit._source.overview" />

                <g-record-field-resource-type
                  [field]="hit._source.resourceType"
                  [layout]="ResourceTypeLayout.ICON_WITH_BADGE"
                  class="absolute bottom-0 left-0 m-2" />
              </div>
              <div class="flex-grow">
                <div
                  class="text-2xl font-semibold line-clamp-1"
                  title="{{ hit._source.resourceTitleObject?.default }}">
                  {{ hit._source.resourceTitleObject?.default }}
                </div>
                <div class="w-full">
                  <p class="line-clamp-2">
                    {{
                      hit._source.resourceAbstractObject?.default
                        | firstSentence
                    }}
                  </p>
                  <div>
                    @for (
                      range of hit._source.resourceTemporalDateRange;
                      track range
                    ) {
                      <p-chip
                        class="pr-2"
                        icon="fa fa-calendar"
                        label="{{ range | gRecordFieldRange: 'YYYY-MM-dd' }}">
                      </p-chip>
                    }
                  </div>
                </div>
              </div>
            </a>
          </div>
        }
      </ng-template>
    </p-dataView>

    @if (search.isSearching()) {
      @for (i of [].constructor(search.pageSize()); track $index) {
        <div class="grid gap-4 mb-2">
          <div class="flex flex-row gap-4">
            <p-skeleton
              size="10rem"
              styleClass="flex-none w-48 h-48 relative rounded-lg border border-gray-300" />
            <div>
              <p-skeleton styleClass="mb-2" />
              <p-skeleton width="10rem" styleClass="mb-2" />
              <p-skeleton width="5rem" styleClass="mb-2" />
            </div>
          </div>
        </div>
      }
    }
  }
}
<!--} @placeholder {
  <p>Loading...</p>
}-->
